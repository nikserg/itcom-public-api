
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTcuNzExIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTU3LjcxMSA0MCI+PGcgaWQ9ItCh0LPRgNGD0L/Qv9C40YDQvtCy0LDRgtGMXzcyIiBkYXRhLW5hbWU9ItCh0LPRgNGD0L/Qv9C40YDQvtCy0LDRgtGMIDcyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzQ0IC03OCkiPjxnIGlkPSLQodC70L7QuV94MDAyMF8xIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNDMuOTkgNzcuOTk3KSI+PGcgaWQ9Il8zMjY2MzA1MjgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC4wMSAuMDAzKSI+PHBhdGggaWQ9ItCa0L7QvdGC0YPRgF8yMCIgZGF0YS1uYW1lPSLQmtC+0L3RgtGD0YAgMjAiIGQ9Ik01LjUgMzguMjU5aDE4LjE1Mkw0LjQ0NyAzMy4xMDhBNi42NDYgNi42NDYgMCAwMS4wMSAyOS4xNzd2My41ODhhNS41MjUgNS41MjUgMCAwMDUuNTA5IDUuNTA5ek01LjQ3NCAzLjU0QTUuNTEyIDUuNTEyIDAgMDAuMDEgOS4wMzR2MTQuOUw1LjQ3NCAzLjU0eiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLS4wMSAxLjcyNikiIGZpbGw9IiMzMzMiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGlkPSLQmtC+0L3RgtGD0YBfMjEiIGRhdGEtbmFtZT0i0JrQvtC90YLRg9GAIDIxIiBkPSJNMzMuNiAzMC40bDQuNjQ1LTE3LjMzYTUuNTI2IDUuNTI2IDAgMDAtMy44ODYtNi43NDRsLTMuNS0uOTM4YTYuNjU0IDYuNjU0IDAgMDEyLjc1NCA1LjM3NXYxOS42MjJ6TTI2LjA3OSA0LjEyM0wxMS40MjkuMTkyYTUuNTI2IDUuNTI2IDAgMDAtNi43NDQgMy44ODZsLS4wMTUuMDNoMjEuMzk0eiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4yNjggLS4wMDMpIiBmaWxsPSIjMGRiMTRiIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBpZD0i0JrQvtC90YLRg9GAXzIyIiBkYXRhLW5hbWU9ItCa0L7QvdGC0YPRgCAyMiIgZD0iTTc0LjgzNyAzMS4xNzljNC40ODEgMCA3LjE0Ni0xLjQgOS41MjgtMy45NDVsLTEuODkxLTIuMDI1YTMuOCAzLjggMCAwMC0uOTY4LS42NyAxLjYzOCAxLjYzOCAwIDAwLTEuNjY3LjI4M2MtLjEzNC4xLS4yNjguMTk0LS40LjI4M0E3LjM4NCA3LjM4NCAwIDAxNzUgMjYuNDc1Yy0zLjk5IDAtNi43NDQtMy4zMi02Ljc0NC03LjMxIDAtNC4wNSAyLjgyOS03LjMxIDYuNzQ0LTcuMzFBNy4zNDkgNy4zNDkgMCAwMTc5LjE1NSAxM2MuMjUzLjE2NC40OTEuMzI4Ljc0NC41MjFhMS40MDUgMS40MDUgMCAwMDEuMy4wODkgOS43ODIgOS43ODIgMCAwMDIuNjItMi40MTJsLjA0NS0uMDYuMDQ1LS4wNi4wNDUtLjA2LjA0NS0uMDYuMDQ1LS4wNmExMS42ODkgMTEuNjg5IDAgMDAtOS4wMTMtMy43NzhjLTE2LjEyNCAwLTE1Ljk0NSAyNC4wNDQtLjE5NCAyNC4wNDR6bTIyLjEyNCAwQTEyLjAzNCAxMi4wMzQgMCAxMDg0LjYzNCAxOS4xNWExMi4wMjUgMTIuMDI1IDAgMDAxMi4zMjcgMTIuMDI5em0uMDYtNC43MmE3LjA2MSA3LjA2MSAwIDAxLTcuMDQyLTcuMzEgNi45NzggNi45NzggMCAwMTYuOTgzLTcuMzFBNy4wNjEgNy4wNjEgMCAwMTEwNCAxOS4xNWE2Ljk3OCA2Ljk3OCAwIDAxLTYuOTc5IDcuMzF6bTI4LjYtNC41MTFjLjIwOC40NjIuNDE3LjkzOC42MSAxLjQyOS4xOTQtLjUwNi40LS45ODMuNjEtMS40NTlzLjQzMi0uOTIzLjY3LTEuMzdMMTMzLjkgNy45ODRhMi4xMTkgMi4xMTkgMCAwMS4zNDItLjUwNiAxLjE5IDEuMTkgMCAwMS40LS4yNjggMS4zMzYgMS4zMzYgMCAwMS41MDYtLjA4OWg1LjA2MnYyNC4wNDNoLTUuMDc3di0xMy41YzAtLjcuMDMtMS40NDQuMS0yLjI0OGwtNi41ODEgMTIuNzc0YTIuMTUgMi4xNSAwIDAxLS44MzQuOTA4IDIuMjU3IDIuMjU3IDAgMDEtMS4xOTEuMzEzaC0uNzg5YTIuMyAyLjMgMCAwMS0xLjE5MS0uMzEzIDIuMjQ4IDIuMjQ4IDAgMDEtLjgzNC0uOTA4bC02LjYxOS0xMi43OWMuMDQ1LjQuMDc0Ljc4OS4xIDEuMTkxcy4wMy43NTkuMDMgMS4wODd2MTMuNWgtNS4wNzdWNy4xMzVoNS4wNjJhMS4zMzYgMS4zMzYgMCAwMS41MDYuMDg5IDEuMTkgMS4xOSAwIDAxLjQuMjY4IDEuNzU4IDEuNzU4IDAgMDEuMzQyLjUwNmw2LjQgMTIuNjI1Yy4yMjMuNDMyLjQ0Ny44NzguNjU1IDEuMzU1em0tODQuMTc4IDkuMjMxSDM1LjgzVjcuMTM1aDUuNjEzek02Mi45MTIgNy4xMzV2NC40MjJoLTYuNzZ2MTkuNjIyaC01LjU4M1YxMS41NTdINDMuODFWNy4xMzVoMTkuMTE3eiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcuNSAzLjQ3NikiIGZpbGw9IiMzMzMiLz48cGF0aCBpZD0i0JrQvtC90YLRg9GAXzIzIiBkYXRhLW5hbWU9ItCa0L7QvdGC0YPRgCAyMyIgZD0iTTI5LjAxNCAzOC4yNTlhNS4yNjUgNS4yNjUgMCAwMDEuODkxLS4zNDIgNS43MyA1LjczIDAgMDAzLjQzOS0zLjY2MiA1LjE0IDUuMTQgMCAwMC4xNjQtMS40ODlWOS4wNDlBNS41MjUgNS41MjUgMCAwMDI5IDMuNTRINi40NDNMLjYyMiAyNS4yNjJhNS41MjYgNS41MjYgMCAwMDMuODg2IDYuNzQ0bDIyLjkxMyA2LjEzNGE1LjYxIDUuNjEgMCAwMDEuNTc5LjExOXoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC4xOTcgMS43MjYpIiBmaWxsPSIjMGRiMTRiIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L2c+PC9nPjwvZz48L3N2Zz4=" />
[![Scrutinizer Code Quality](https://scrutinizer-ci.com/g/nikserg/itcom-public-api/badges/quality-score.png?b=main)](https://scrutinizer-ci.com/g/nikserg/itcom-public-api/?branch=main)

# Публичный API для работы с CRM Айтиком

## Установка

`composer require nikserg/itcom-public-api`

## Использование

В API есть два режима авторизации:

- Как пользователь, с использованием bearer-токена пользователя. В таком случае API имеет доступ ко всем заявкам, к
  которым имеет доступ пользователь.
- Для доступа только к одной заявке, с использованием ее ID и токена доступа. В таком случае, создание новых заявок
  будет недоступно, и доступ будет только к одной заявке.

Для первого режима используется класс `UserClient`, для второго - `IndividualRequestClient`.

Пример использования с авторизацией как пользователь:
```php
$client = new \nikserg\ItcomPublicApi\BaseClient('<bearer token>');
$createdCertificate = $client->createOrUpdate(['EPGU']);
echo $createdCertificate->id; //ID созданной заявки

$client->createOrUpdate(['EPGU'], $createdCertificate->id, 'new name'); //Обновление заявки
```

## Тестирование

Чтобы система не отправляла реальные запросы, можно вместо класса `\nikserg\ItcomPublicApi\UserClient` использовать
класс `\nikserg\ItcomPublicApi\MockUserClient`.

@todo Сделать аналогичное для `IndividualRequestClient`.
